<!DOCTYPE html> <html lang="ja-JP"> <head> <meta charset="utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=description content="Kobe University"> <meta name=author content="Kenji Sato"> <title>Editing Google form auto-response message with a GUI | en.kenjisato.jp</title> <!-- Begin Jekyll SEO tag --> <title>Editing Google form auto-response message with a GUI</title> <meta property="og:title" content="Editing Google form auto-response message with a GUI" /> <link rel="canonical" href="http://en.kenjisato.jp//editing-google-form-auto-response/" itemprop="url" /> <meta property='og:url' content='http://en.kenjisato.jp//editing-google-form-auto-response/' /> <meta property="og:type" content="article" /> <link rel="prev" href="http://en.kenjisato.jp//moving-to-blogger/" title="Moving to Blogger" /> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "NewsArticle", "headline": "Editing Google form auto-response message with a GUI", "image": null, "datePublished": "2013-03-11T14:47:00+09:00", "description": null } </script> <!-- End Jekyll SEO tag --> <link rel="icon" type="image/png" href="/assets/images/favicon/favicon-64x64.png" sizes="64x64" /> <link rel="icon" type="image/png" href="/assets/images/favicon/favicon-48x48.png" sizes="48x48" /> <link rel="icon" type="image/png" href="/assets/images/favicon/favicon-32x32.png" sizes="32x32" /> <link rel="icon" type="image/png" href="/assets/images/favicon/favicon-16x16.png" sizes="16x16" /> <link rel="canonical" href="//editing-google-form-auto-response/"> <link rel="alternate" type="application/rss+xml" title="" href="//feed.xml" /> <style>.highlight .c { color: #998; font-style: italic; } .highlight .err { color: #a61717; background-color: #e3d2d2; } .highlight .k { font-weight: bold; } .highlight .o { font-weight: bold; } .highlight .cm { color: #998; font-style: italic; } .highlight .cp { color: #999; font-weight: bold; } .highlight .c1 { color: #998; font-style: italic; } .highlight .cs { color: #999; font-weight: bold; font-style: italic; } .highlight .gd { color: #000; background-color: #fdd; } .highlight .gd .x { color: #000; background-color: #faa; } .highlight .ge { font-style: italic; } .highlight .gr { color: #a00; } .highlight .gh { color: #999; } .highlight .gi { color: #000; background-color: #dfd; } .highlight .gi .x { color: #000; background-color: #afa; } .highlight .go { color: #888; } .highlight .gp { color: #555; } .highlight .gs { font-weight: bold; } .highlight .gu { color: #800080; font-weight: bold; } .highlight .gt { color: #a00; } .highlight .kc { font-weight: bold; } .highlight .kd { font-weight: bold; } .highlight .kn { font-weight: bold; } .highlight .kp { font-weight: bold; } .highlight .kr { font-weight: bold; } .highlight .kt { color: #458; font-weight: bold; } .highlight .m { color: #099; } .highlight .s { color: #d14; } .highlight .n { color: #333; } .highlight .na { color: #008080; } .highlight .nb { color: #0086b3; } .highlight .nc { color: #458; font-weight: bold; } .highlight .no { color: #008080; } .highlight .ni { color: #800080; } .highlight .ne { color: #900; font-weight: bold; } .highlight .nf { color: #900; font-weight: bold; } .highlight .nn { color: #555; } .highlight .nt { color: #000080; } .highlight .nv { color: #008080; } .highlight .ow { font-weight: bold; } .highlight .w { color: #bbb; } .highlight .mf { color: #099; } .highlight .mh { color: #099; } .highlight .mi { color: #099; } .highlight .mo { color: #099; } .highlight .sb { color: #d14; } .highlight .sc { color: #d14; } .highlight .sd { color: #d14; } .highlight .s2 { color: #d14; } .highlight .se { color: #d14; } .highlight .sh { color: #d14; } .highlight .si { color: #d14; } .highlight .sx { color: #d14; } .highlight .sr { color: #009926; } .highlight .s1 { color: #d14; } .highlight .ss { color: #990073; } .highlight .bp { color: #999; } .highlight .vc { color: #008080; } .highlight .vg { color: #008080; } .highlight .vi { color: #008080; } .highlight .il { color: #099; } .highlight .gc { color: #999; background-color: #eaf2f5; } /* normalize.css v3.0.2 | MIT License | git.io/normalize */ html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ } body { margin: 0; } article, aside, details, figcaption, figure, footer, header, hgroup, main, menu, nav, section, summary { display: block; } audio, canvas, progress, video { display: inline-block; /* 1 */ vertical-align: baseline; /* 2 */ } audio:not([controls]) { display: none; height: 0; } a { background-color: transparent; } a:active, a:hover { outline: 0; } h1 { font-size: 2em; margin: 0.67em 0; } img { border: 0; } hr { box-sizing: content-box; height: 0; } pre { overflow: auto; } code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1em; } body, html { font-size: 62.5%; } body { line-height: 1; font: 16px "Helvetica Neue", Helvetica, Arial, sans-serif; } color alpha { -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } h1, h2, h3, h4 { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #222; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } h1 { font-size: 3rem; letter-spacing: -1px; color: #222; font-weight: 700; } h2 { font-size: 2.2rem; } h3 { font-size: 2rem; } h4 { font-size: 1.6rem; } a { color: #4b0082; text-decoration: none; } p { line-height: 1.7; color: #666; font-weight: 300; margin-bottom: 20px; letter-spacing: 0.4px; } @media only screen and (max-width: 400px) { p { letter-spacing: 0.2px; } } strong { font-weight: 400; color: #000; } ul li, ol li { line-height: 2.4rem; font-weight: 300; color: #666; } img, pre, iframe { max-width: 100%; } img, pre { border-radius: 4px; } blockquote { padding-left: 15px; border-left: 3px solid #eee; } hr { border: none; height: 1px; margin: 40px auto; background: #eee; width: 100%; } code, tt { padding: 1px 3px; font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 12px; line-height: 20px; white-space: pre-wrap; background: #fff; border-radius: 2px; border-radius: 2px; } pre { box-sizing: border-box; margin: 0 0 1.75em 0; width: 100%; padding: 5px 10px; font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 1.2rem; line-height: 2rem; white-space: pre; overflow: auto; background: #fff; border: 1px solid #ededed; border-radius: 2px; } .site-wrapper { height: 100%; max-width: 560px; width: 96%; margin: 0 auto; } @media only screen and (max-width: 400px) { .site-wrapper { width: 88%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .site-wrapper { width: 88%; } } .icon { display: inline-block; width: 17px; height: 17px; fill: #000; color: #000; } .home, .blog { margin-top: 125px; } .home .home__header, .blog .home__header { display: block; margin: 0 auto; text-align: center; } .home .home__header img, .blog .home__header img { width: 125px; margin-bottom: 25px; border-radius: 100%; } .home .home__header h1, .blog .home__header h1, .home .home__header h2, .blog .home__header h2 { margin: 0; } .home .home__header h1, .blog .home__header h1 { font-size: 4rem; margin-bottom: 13px; } .home .home__header h2, .blog .home__header h2 { font-size: 1.85rem; font-weight: 300; font-style: normal; color: #aaa; width: 70%; margin: 0 auto 30px; } .home .home__header h2 a, .blog .home__header h2 a { font-weight: 200; } .home .home__header .home__header-social, .blog .home__header .home__header-social { margin-top: 20px; } .home .home__header .home__header-social a, .blog .home__header .home__header-social a { margin: 0 3px; } .home .home__header .home__header-social a:hover svg, .blog .home__header .home__header-social a:hover svg { fill: #4b0082; } .home .home__header .home__header-social svg, .blog .home__header .home__header-social svg { -webkit-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s; } .home .home__sections, .blog .home__sections { border-top: 1px solid #ededed; margin-top: 30px; padding-top: 40px; position: relative; } .home .home__sections:before, .blog .home__sections:before { display: block; content: " "; width: 7px; height: 7px; border: #ededed 1px solid; position: absolute; top: -5px; left: 50%; margin-left: -5px; background: #fff; box-shadow: #fff 0 0 0 5px; border-radius: 3px; } .home .home__sections .home__sections-single, .blog .home__sections .home__sections-single { display: block; width: 95%; margin: 0 auto; } .home .home__sections .home__sections-single:hover h3, .blog .home__sections .home__sections-single:hover h3 { color: #4b0082; } .home .home__sections .home__sections-single:hover aside, .blog .home__sections .home__sections-single:hover aside { color: #666; } .home .home__sections .home__sections-single a, .blog .home__sections .home__sections-single a { width: 100%; height: 100%; display: block; padding: 20px 0; } .home .home__sections .home__sections-single h3, .blog .home__sections .home__sections-single h3 { margin: 0; width: 75%; font-weight: 500; -webkit-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s; } .home .home__sections .home__sections-single aside, .blog .home__sections .home__sections-single aside { position: relative; top: 2px; margin: 0; width: 25%; float: right; font-weight: 300; color: #aaa; text-align: right; -webkit-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s; } .page { margin-top: 125px; } .page h1 { text-align: center; margin-bottom: 6rem; } .page .home__sections { border-top: 1px solid #ededed; margin-top: 30px; padding-top: 50px; } .page .home__sections .home__sections-single { display: block; border-bottom: 1px solid #ededed; width: 95%; margin: 0 auto; } .page .home__sections .home__sections-single a { width: 100%; height: 100%; display: block; padding: 30px 0; } .page .home__sections .home__sections-single:last-child { border: 0; } .page .home__sections .home__sections-single h3 { margin: 0; width: 75%; font-weight: 500; } .page .home__sections .home__sections-single aside { position: relative; top: 0px; margin: 0; width: 25%; float: right; font-weight: 300; color: #aaa; } .post { margin-top: 125px; } .post h1.post__title { text-align: center; margin-bottom: 3rem; } .post h2, .post h3, .post h4 { margin-top: 40px; } .post span time { color: #aaa; font-weight: 300; font-size: 1.4rem; text-transform: uppercase; text-align: center; display: block; margin-bottom: 6rem; letter-spacing: 1px; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } .nav { position: absolute; right: 0; top: 0; } .nav ul { list-style: none; margin: 0; padding: 0 13px 0; } .nav ul li { display: inline-block; } .nav ul li a { display: inline-block; font-weight: 300; font-size: 1.4rem; padding: 20px 10px; } .home__header-nav { margin-top: 40px; text-align: center; } .home__header-nav ul { list-style: none; margin: 0; padding: 0; } .home__header-nav ul li { display: inline-block; } .home__header-nav ul li a { display: inline-block; font-weight: 300; font-size: 2rem; padding: 7px 15px; margin: 0; border-radius: 4%; -webkit-transition: all 0.4s ease-in-out; transition: all 0.4s ease-in-out; width: 70px; } .home__header-nav ul li a:hover { color: #666; } footer { border-top: 1px solid #ededed; padding: 40px 0; margin: 40px 0 0; font-size: 1.3rem; color: #aaa; font-weight: 300; text-align: center; position: relative; } footer:before { display: block; content: " "; width: 7px; height: 7px; border: #ededed 1px solid; position: absolute; top: -5px; left: 50%; margin-left: -5px; background: #fff; box-shadow: #fff 0 0 0 5px; border-radius: 3px; } footer a { display: inline; } footer a svg { width: 15px !important; fill: #aaa !important; -webkit-transition: ease-in-out all 0.3s; transition: ease-in-out all 0.3s; position: relative; top: 3px; } footer a svg:hover { fill: #4b0082 !important; } .disqus { margin: 0 auto; max-width: 100%; padding: 40px 0; } .author { padding: 3rem 0; border-bottom: 1px solid #ededed; border-top: 1px solid #ededed; max-width: 100%; margin: 9rem auto 0; } .author .author__picture { width: 90%; border-radius: 100%; } .author .author__name, .author .author__bio { width: 60%; display: inline-block; } .author .author__name { font-size: 1.5rem; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-weight: 500; margin: 6px 0 0; } @media only screen and (max-width: 400px) { .author .author__name { width: 100%; display: block; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author .author__name { width: 100%; display: block; } } .author .author__bio { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-weight: 300; color: #aaa; font-size: 1.3rem; text-align: justify; line-height: 1.5; margin: 0; } @media only screen and (max-width: 400px) { .author .author__bio { width: 100%; display: block; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author .author__bio { width: 100%; display: block; } } .author .author__share { float: right; width: 40%; display: inline; text-align: right; position: relative; top: -10px; } @media only screen and (max-width: 400px) { .author .author__share { width: 100%; display: block; top: 0; text-align: left; float: none; margin-top: 5px; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author .author__share { width: 100%; display: block; top: 0; text-align: left; float: none; margin-top: 5px; } } .author .author__share svg { fill: #fff; position: relative; top: 3px; margin-right: 4px; } .author .author__share .twitter, .author .author__share .facebook { display: inline; vertical-align: middle; font-size: 13px; font-weight: 700; color: #fff; padding: 6px 10px; border-radius: 3px; margin-left: 5px; } @media only screen and (max-width: 400px) { .author .author__share .twitter, .author .author__share .facebook { margin: 0 5px 10px 0; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author .author__share .twitter, .author .author__share .facebook { margin: 0 5px 10px 0; } } .author .author__share .twitter { background: #4fafed; } .author .author__share .facebook { background: #4361b3; } .author .author__left { width: 10%; display: inline-block; } @media only screen and (max-width: 400px) { .author .author__left { width: 20%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author .author__left { width: 20%; } } .author .author__right { width: 89%; display: inline-block; vertical-align: top; } @media only screen and (max-width: 400px) { .author .author__right { width: 78%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author .author__right { width: 78%; } } .evidence { background-image: -webkit-linear-gradient(top, rgba(39,243,106,0.15), rgba(39,243,106,0.15)); background-image: linear-gradient(to bottom, rgba(39,243,106,0.15), rgba(39,243,106,0.15)); color: #222; } .star h3 { width: auto !important; display: inline; background-image: -webkit-linear-gradient(top, rgba(39,243,106,0.15), rgba(39,243,106,0.15)); background-image: linear-gradient(to bottom, rgba(39,243,106,0.15), rgba(39,243,106,0.15)); } </style> </head> <body> <div class="site-wrapper"> <div class="editing google form auto-response message with a gui"> <nav class="nav"> <ul> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> </ul> </nav> <h1 class="post__title">Editing Google form auto-response message with a GUI</h1> <span><time datetime="11-03-2013">Monday. March 11, 2013</time></span> <p>A typical scenario when using Google's live form might be like: A programmer writes a short script to do some automatic tasks such as auto-response on form submit, a non-programmer colleague tests, and then the programmer will do minor tweaks whenever some change occur. Even when the change is limited in the message body. So, let's make a template and be free from supporting tasks. The GUI for template editing looks like the picture below: </p> <a href="http://4.bp.blogspot.com/-wK_s72Xy910/UT1rhNhaeEI/AAAAAAAANvk/sl5_DfaDq2g/s1600/1.png" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-wK_s72Xy910/UT1rhNhaeEI/AAAAAAAANvk/sl5_DfaDq2g/s320/1.png" /></a> <p>The resulting auto-response message looks like: </p> <a href="http://2.bp.blogspot.com/-gNOqAl1cGJo/UT1sAVBSq5I/AAAAAAAANvs/72DYMoJaTbQ/s1600/2.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-gNOqAl1cGJo/UT1sAVBSq5I/AAAAAAAANvs/72DYMoJaTbQ/s320/2.png" /></a> <p><strong>Please use the following script on your own responsibility!!</strong></p> <p>I assume the form has three columns "<b>Timestamp</b>", "<b>Name</b>", and "<b>Email Address</b>." The "<b>Timestamp</b>" column might have a different name if your Google docs's language is not set to English. And please create a sheet named "<b>Configure</b>" with specific entries. See the picture below.</p> <a href="http://2.bp.blogspot.com/-VeqApHuCWCY/UT1tQvzfhjI/AAAAAAAANv4/KF0Vw5jYpIY/s1600/3.png" imageanchor="1" ><img border="0" src="http://2.bp.blogspot.com/-VeqApHuCWCY/UT1tQvzfhjI/AAAAAAAANv4/KF0Vw5jYpIY/s320/3.png" /></a> <p>This second sheet is used to store the template information. I owe this idea to handle global variables to <a href="http://googleappsdeveloper.blogspot.jp/2012/05/insider-tips-for-using-apps-script-and.html">an article in Google Apps Developer Blog</a>. If you wish to share configuration information for multiple forms, you might want to store it to another spreadsheet. You can do it with a minor modification. Let's see the scripts.</p> <p>Base variables and functions are defined in the following script.</p> <script type='syntaxhighlighter' class='brush: javascript' title='Base'><![CDATA[ // YOU NEED TO SPECIFY THE COLUMN NAME FOR EMAIL ADDRESSES var ADDRESS_COLUMN = "Email Address"; // ADMINISTRATOR'S ADDRESS var ADMIN = "kenji@kenjisato.jp"; // HANDLING GLOBAL VARIABLES // http://googleappsdeveloper.blogspot.jp/2012/05/insider-tips-for-using-apps-script-and.html var SHT_CONFIG = 'Configuration'; var globals = new Array(); function LoadGlobals(g) { gout = (g.length == 0) ? LoadGlobals_( SpreadsheetApp.getActive(), SHT_CONFIG) : g; return gout; } // Generate gloabal variables to be loaded into globals array function LoadGlobals_(wb, configSheet) { var configsheet = wb.getSheetByName(configSheet); var tGlobals = new Array(); // Config data is structured as VARIABLE, ISARRAY, VALUE(S) // and includes that as the header row var cfgdata = configsheet.getDataRange().getValues(); for (i = 1; i < cfgdata.length; i++) { switch (cfgdata[i][1]) { case 'ARRAY': // treat as an array - javascript puts a null value in the // array if you split an empty string... if (cfgdata[i][2].length == 0) { tGlobals[cfgdata[i][0]] = new Array(); } else { tGlobals[cfgdata[i][0]] = cfgdata[i][2].split(','); } break; // Define your own YOURDATATYPE using your customTreatment function (or // just perform the treatment here) case 'YOURDATATYPE': tGlobals[cfgdata[i][0]] = customTreatment(cfgdata[i][2]); break; default: // treat as generic data (string) tGlobals[cfgdata[i][0]] = cfgdata[i][2]; } } return tGlobals } // Update global variables function UpdateGlobals() { var configsheet = SpreadsheetApp.getActive().getSheetByName(SHT_CONFIG); var range = configsheet.getDataRange(); var cfgdata = range.getValues(); for (i = 1; i < cfgdata.length; i++) { var tmp = (typeof globals[cfgdata[i][0]] === "undefined") ? "" : globals[cfgdata[i][0]]; switch (cfgdata[i][1]) { case 'ARRAY': range.getCell(i+1, 3).setValue(tmp.join(",")); break; // Define your own YOURDATATYPE using your customTreatment function (or // just perform the treatment here) case 'YOURDATATYPE': // Do something you want it to be done break; default: // treat as generic data (string) range.getCell(i+1, 3).setValue(tmp); } } globals = []; globals = LoadGlobals(globals); } // GETTING CLUMN NAMES function getColNames(sheet) { var c = sheet.getLastColumn(); return sheet.getRange(1, 1, 1, c).getValues()[0]; } // ADDING MENUS function onOpen(){ var arrAutoReply = [ {name: "Template", functionName: "templateUi"} ]; var spreadsheet = SpreadsheetApp.getActiveSpreadsheet(); spreadsheet.addMenu("AUTOREPLY", arrAutoReply); } ]]></script> <p>Making GUI with the following script. </p><script type='syntaxhighlighter' class='brush: javascript' title='GUI'><![CDATA[ function templateUi() { globals = LoadGlobals(globals); // GUI Initialization var ss = SpreadsheetApp.getActiveSpreadsheet(); var myapp = UiApp.createApplication().setTitle( "Auto Reply Message" ).setHeight(550).setWidth(600); // Headers var headGrid = myapp.createGrid(6, 2); var nameBox = myapp.createTextBox().setName('nameBox').setId('nameBox').setWidth('500px'); var toBox = myapp.createTextBox().setName('toBox').setId('toBox').setWidth('500px').setEnabled(false); var ccBox = myapp.createTextBox().setName('ccBox').setId('ccBox').setWidth('500px'); var bccBox = myapp.createTextBox().setName('bccBox').setId('bccBox').setWidth('500px'); var repBox = myapp.createTextBox().setName('repBox').setId('repBox').setWidth('500px'); var titleBox = myapp.createTextBox().setName('titleBox').setId('titleBox').setWidth('500px'); headGrid.setCellSpacing(2); headGrid.setWidget(0, 0, myapp.createLabel( "Sender" ).setWidth('50px')); headGrid.setWidget(0, 1, nameBox); headGrid.setWidget(1, 0, myapp.createLabel( "To" ).setWidth('50px')); headGrid.setWidget(1, 1, toBox); headGrid.setWidget(2, 0, myapp.createLabel( "CC" ).setWidth('50px')); headGrid.setWidget(2, 1, ccBox); headGrid.setWidget(3, 0, myapp.createLabel( "BCC" ).setWidth('50px')); headGrid.setWidget(3, 1, bccBox); headGrid.setWidget(4, 0, myapp.createLabel( "ReplyTo" ).setWidth('50px')); headGrid.setWidget(4, 1, repBox); headGrid.setWidget(5, 0, myapp.createLabel( "Subject" ).setWidth('50px')); headGrid.setWidget(5, 1, titleBox); // Body var bodyGrid = myapp.createGrid(1,1); var bodyBox = myapp.createTextArea().setName('bodyBox').setId('bodyBox').setWidth('555px').setHeight('250px'); bodyGrid.setWidget(0, 0, bodyBox); // Keys var keyGrid = myapp.createGrid(1, 2); var keyBox = myapp.createTextBox().setName('keyBox').setId('keyBox').setWidth('500px').setEnabled(false); keyGrid.setCellSpacing(2); keyGrid.setWidget(0, 0, myapp.createLabel( "Keys" ).setWidth('50px')); keyGrid.setWidget(0, 1, keyBox); var h = getColNames(ss.getSheets()[0]); var keys = ""; for (var i in h) { keys = keys + "{{" + h[i] + "}} "; } keyBox.setValue(keys); // Save Button var saveButton = myapp.createButton( "SAVE" ).setId("saveButton").setWidth('270px'); var clickhandler = myapp.createServerClickHandler("onClickSaveButton"); clickhandler.addCallbackElement(nameBox); clickhandler.addCallbackElement(ccBox); clickhandler.addCallbackElement(bccBox); clickhandler.addCallbackElement(repBox); clickhandler.addCallbackElement(titleBox); clickhandler.addCallbackElement(bodyBox); saveButton.addClickHandler(clickhandler); // Cancel Button var cancelButton = myapp.createButton( "CANCEL" ).setWidth('270px'); var clickhandler = myapp.createServerClickHandler("onClickCancelButton"); cancelButton.addClickHandler(clickhandler) // Arrange Buttons var buttonPanel = myapp.createHorizontalPanel(); buttonPanel.add(saveButton); buttonPanel.add(cancelButton); // Arrange Panels var mainPanel = myapp.createVerticalPanel(); mainPanel.add(headGrid); mainPanel.add(bodyGrid); mainPanel.add(keyGrid); mainPanel.add(buttonPanel); // Fill in the boxes toBox.setValue("(Submitted value)"); var name = (typeof globals.name === "undefined") ? "" : globals.name; nameBox.setValue(name); var cc = (typeof globals.cc === "undefined") ? "" : globals.cc; ccBox.setValue(cc); var bcc = (typeof globals.bcc === "undefined") ? "" : globals.bcc; bccBox.setValue(bcc); var rep = (typeof globals.replyTo === "undefined") ? "" : globals.replyTo; repBox.setValue(rep); var subject = (typeof globals.subject === "undefined") ? "" : globals.subject; titleBox.setValue(subject); var body = (typeof globals.body === "undefined") ? "" : globals.body; bodyBox.setValue(body); myapp.add(mainPanel); ss.show(myapp); } function onClickSaveButton(e){ var app = UiApp.getActiveApplication(); globals["name"] = e.parameter.nameBox; globals["cc"] = e.parameter.ccBox; globals["bcc"] = e.parameter.bccBox; globals["replyTo"] = e.parameter.repBox; globals["subject"] = e.parameter.titleBox; globals["body"] = e.parameter.bodyBox; UpdateGlobals(); app.close();   return app; } function onClickCancelButton(e){   var app = UiApp.getActiveApplication();   app.close();   return app; } ]]></script> <p>Lastly, setup the script for auto-response function. </p> <script type='syntaxhighlighter' class='brush: javascript' title='Reply'><![CDATA[ // Auto Reply function onFormSubmit(e) { globals = LoadGlobals(globals); try { var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet(); var h = getColNames(sheet); var toAddr = e.namedValues[ADDRESS_COLUMN].toString(); if ( typeof globals.subject === "undefined" ) { var subject = "no title"; } else { var subject = globals.subject; } var msg = globals.body; // Processing the template for(var i in h){ if ( typeof e.namedValues[h[i]] === "undefined" ) { continue; } subject = subject.replace(new RegExp("{{" + h[i] + "}}", "g"), e.namedValues[h[i]].toString()); msg = msg.replace(new RegExp("{{" + h[i] + "}}", "g"), e.namedValues[h[i]].toString()); } var cc = (typeof globals.cc === "undefined") ? "" : globals.cc; var replyTo = (typeof globals.replyTo === "undefined") ? "" : globals.replyTo; var name = (typeof globals.name === "undefined") ? "" : globals.name; // Plaintext Message // MailApp.sendEmail(toAddr, subject, msg, {cc: cc, replyTo : replyTo, name: name }); // HTML Message MailApp.sendEmail(toAddr, subject, "", {htmlBody: msg, cc: cc, replyTo : replyTo, name: name }); } catch (e) { // Sending an error message MailApp.sendEmail(ADMIN, "Error report", e.message); } } ]]></script> <p>Done!</p> <section class="author"> <div class="author__left"> <img class="author__picture reyes" src="/assets/images/profile.jpg" alt="Kenji Sato"> </div> <div class="author__right"> <h4 class="author__name">Kenji Sato</h4> <p class="author__bio">Kobe University</p> <div class="author__share"> <a class="twitter" href="https://twitter.com/intent/tweet?text=//editing-google-form-auto-response/ - Editing Google form auto-response message with a GUI by @kenjisato"> <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg><span class="icon-twitter">Tweet</span> </a> <a class="facebook" href="javascript:void(0)" onclick="window.open('https://facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href), 'facebook-share-dialog', 'width=626,height=436'); return false;"> <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg><span class="icon-facebook-rect">Share</span> </a> </div> </div> </section> <section class="disqus"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'kenjisato1983'; var disqus_developer = 0; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> </section> <footer> Kenji Sato © 2016 <a href="/feed.xml" target="_blank"><svg class="icon icon-rss"><use xlink:href="#icon-rss"></use></svg></a> </footer> </div> </div> <svg display="none" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <defs> <symbol id="icon-rss" viewBox="0 0 1024 1024"> <title>rss</title> <path class="path1" d="M122.88 122.88v121.19c362.803 0 656.896 294.195 656.896 656.998h121.293c0-429.773-348.416-778.189-778.189-778.189zM122.88 365.414v121.293c228.813 0 414.362 185.498 414.362 414.413h121.242c0-295.834-239.821-535.706-535.603-535.706zM239.053 668.621c-64.205 0-116.224 52.122-116.224 116.275s52.019 116.224 116.224 116.224 116.173-52.019 116.173-116.224-51.968-116.275-116.173-116.275z"></path> </symbol> <symbol id="icon-gplus" viewBox="0 0 20 20"> <title>gplus</title> <path class="path1" d="M1.99 5.589c0 1.493 0.499 2.572 1.482 3.205 0.805 0.519 1.74 0.597 2.226 0.597 0.118 0 0.212-0.005 0.278-0.009 0 0-0.154 1.003 0.59 1.996l-0.034-0.001c-1.289 0-5.494 0.27-5.494 3.727 0 3.517 3.862 3.695 4.636 3.695 0.061 0 0.096-0.001 0.096-0.001 0.009 0 0.064 0.002 0.158 0.002 0.497 0 1.782-0.062 2.976-0.643 1.548-0.751 2.334-2.059 2.334-3.885 0-1.765-1.196-2.815-2.070-3.583-0.533-0.468-0.994-0.872-0.994-1.265 0-0.4 0.336-0.701 0.762-1.082 0.688-0.616 1.338-1.493 1.338-3.151 0-1.458-0.189-2.436-1.354-3.056 0.122-0.062 0.551-0.107 0.764-0.137 0.631-0.086 1.554-0.184 1.554-0.699v-0.099h-4.598c-0.046 0.001-4.65 0.172-4.65 4.389zM9.413 14.602c0.088 1.406-1.115 2.444-2.921 2.575-1.834 0.135-3.345-0.691-3.433-2.097-0.042-0.675 0.254-1.336 0.835-1.863 0.59-0.533 1.398-0.862 2.279-0.928 0.104-0.006 0.207-0.011 0.31-0.011 1.697 0 2.847 0.998 2.93 2.324zM8.212 4.626c0.451 1.587-0.23 3.246-1.315 3.552-0.125 0.035-0.254 0.053-0.384 0.053-0.995 0-1.98-1.006-2.345-2.392-0.204-0.779-0.188-1.459 0.046-2.114 0.23-0.643 0.643-1.079 1.163-1.225 0.125-0.036 0.255-0.053 0.385-0.053 1.2 0 1.972 0.498 2.45 2.179zM15.961 8.082v-3h-1.9v3h-3v1.9h3v3h1.9v-3h3v-1.9h-3z" fill="#000000"></path> </symbol> <symbol id="icon-facebook" viewBox="0 0 1024 1024"> <title>facebook</title> <path class="path1" d="M870.4 51.2h-716.8c-56.32 0-102.4 46.080-102.4 102.4v716.8c0 56.371 46.080 102.4 102.4 102.4h358.4v-358.4h-102.4v-126.72h102.4v-104.96c0-110.797 62.054-188.621 192.819-188.621l92.314 0.102v133.376h-61.286c-50.893 0-70.246 38.195-70.246 73.626v86.528h131.482l-29.082 126.669h-102.4v358.4h204.8c56.32 0 102.4-46.029 102.4-102.4v-716.8c0-56.32-46.080-102.4-102.4-102.4z"></path> </symbol> <symbol id="icon-twitter" viewBox="0 0 1024 1024"> <title>twitter</title> <path class="path1" d="M886.579 319.795c0.41 8.294 0.563 16.691 0.563 24.986 0 255.488-194.406 549.99-549.888 549.99-109.21 0-210.739-32-296.294-86.886 15.155 1.792 30.515 2.714 46.080 2.714 90.624 0 173.926-30.925 240.026-82.688-84.531-1.587-155.955-57.395-180.531-134.195 11.776 2.202 23.91 3.379 36.352 3.379 17.664 0 34.765-2.304 50.944-6.707-88.422-17.818-155.034-95.898-155.034-189.594 0-0.819 0-1.587 0-2.406 26.061 14.49 55.91 23.194 87.552 24.218-51.866-34.714-86.016-93.798-86.016-160.922 0-35.379 9.523-68.608 26.214-97.178 95.283 116.992 237.773 193.894 398.387 201.984-3.277-14.182-4.966-28.877-4.966-44.083 0-106.701 86.477-193.178 193.229-193.178 55.603 0 105.83 23.398 141.107 60.979 43.981-8.704 85.35-24.781 122.726-46.899-14.438 45.107-45.107 82.995-84.992 106.906 39.117-4.71 76.288-15.002 111.002-30.413-25.907 38.81-58.675 72.806-96.461 99.994z"></path> </symbol> <symbol id="icon-github" viewBox="0 0 1024 1024"> <title>github</title> <path class="path1" d="M674.816 579.021c-36.762 0-66.56 41.318-66.56 92.109 0 50.893 29.798 92.211 66.56 92.211s66.56-41.318 66.56-92.211c-0.051-50.79-29.798-92.109-66.56-92.109zM906.547 339.251c7.629-18.688 7.936-124.877-32.512-226.611 0 0-92.723 10.189-233.011 106.496-29.44-8.192-79.258-12.186-128.973-12.186-49.818 0-99.584 3.994-129.024 12.186-140.339-96.307-233.062-106.496-233.062-106.496-40.397 101.734-39.987 207.923-32.461 226.611-47.514 51.61-76.544 113.613-76.544 198.195 0 367.923 305.306 373.811 382.31 373.811 17.51 0 52.122 0.102 88.781 0.102 36.608 0 71.27-0.102 88.678-0.102 77.107 0 382.31-5.888 382.31-373.811 0-84.582-28.979-146.586-76.493-198.195zM513.434 866.048h-2.867c-193.075 0-343.501-22.989-343.501-210.688 0-45.005 15.872-86.682 53.606-121.293 62.822-57.702 169.216-27.187 289.894-27.187 0.512 0 1.024 0 1.485 0 0.512 0 0.922 0 1.382 0 120.678 0 227.123-30.515 289.997 27.187 37.632 34.611 53.504 76.288 53.504 121.293 0 187.699-150.374 210.688-343.501 210.688zM349.235 579.021c-36.762 0-66.56 41.318-66.56 92.109 0 50.893 29.798 92.211 66.56 92.211 36.813 0 66.611-41.318 66.611-92.211 0-50.79-29.798-92.109-66.611-92.109z"></path> </symbol> <symbol id="icon-youtube" viewBox="0 0 1024 1024"> <title>youtube</title> <path class="path1" d="M512 117.76c-503.194 0-512 44.749-512 394.24s8.806 394.24 512 394.24 512-44.749 512-394.24-8.806-394.24-512-394.24zM676.096 529.101l-229.888 107.315c-20.122 9.318-36.608-1.126-36.608-23.347v-202.138c0-22.17 16.486-32.666 36.608-23.347l229.888 107.315c20.122 9.421 20.122 24.781 0 34.202z"></path> </symbol> <symbol id="icon-mail" viewBox="0 0 1024 1024"> <title>mail</title> <path class="path1" d="M80.589 270.643c24.986 13.414 371.098 199.373 384 206.285s29.594 10.189 46.387 10.189c16.794 0 33.485-3.277 46.387-10.189s359.014-192.87 384-206.285c25.037-13.466 48.691-65.843 2.765-65.843h-866.253c-45.926 0-22.272 52.378 2.714 65.843zM952.986 383.437c-28.416 14.797-378.214 197.069-395.622 206.182s-29.594 10.189-46.387 10.189-28.979-1.075-46.387-10.189-365.21-191.437-393.626-206.234c-19.968-10.445-19.763 1.792-19.763 11.213s0 373.402 0 373.402c0 21.504 28.979 51.2 51.2 51.2h819.2c22.221 0 51.2-29.696 51.2-51.2 0 0 0-363.93 0-373.35s0.205-21.658-19.814-11.213z"></path> </symbol> <symbol id="icon-spotify" viewBox="0 0 1024 1024"> <title>spotify</title> <path class="path1" d="M512 61.44c-248.883 0-450.56 201.626-450.56 450.56 0 248.781 201.677 450.56 450.56 450.56 248.934 0 450.509-201.728 450.509-450.56 0-248.883-201.523-450.56-450.509-450.56zM690.074 742.502c-8.858 0-15.053-3.379-21.555-7.322-60.877-36.915-136.294-56.269-218.010-56.269-41.677 0-86.682 4.966-133.632 14.592l-5.734 1.434c-5.939 1.434-12.032 3.021-16.691 3.021-18.995 0-33.843-14.746-33.843-33.587 0-19.098 10.752-32.614 28.774-35.994 56.115-12.8 108.954-19.046 161.382-19.046 94.976 0 179.866 22.016 252.467 65.485 12.442 7.27 20.275 15.667 20.275 34.202-0.051 18.483-15.002 33.485-33.434 33.485zM736.819 611.379c-10.598 0-17.562-4.045-23.706-7.629-109.722-65.075-273.050-86.682-407.603-50.842-2.253 0.666-4.301 1.28-6.144 1.894-5.069 1.587-9.779 3.174-16.435 3.174-22.118 0-40.090-18.074-40.090-40.346 0-21.453 11.213-36.454 31.437-42.189 51.866-14.234 100.557-23.654 170.65-23.654 113.254 0 223.078 28.416 309.146 79.923 15.667 8.96 22.784 21.197 22.784 39.475 0 22.221-17.971 40.192-40.038 40.192zM789.862 461.875c-9.984 0-16.128-2.406-25.344-7.373-74.394-44.646-190.464-71.219-310.733-71.219-62.669 0-119.603 6.912-169.267 20.326-1.69 0.41-3.277 0.87-5.018 1.382-5.274 1.587-11.878 3.482-18.688 3.482-26.419 0-47.053-20.89-47.053-47.565 0-23.194 13.005-40.909 34.816-47.36 59.955-17.715 128.973-26.675 205.107-26.675 137.114 0 267.571 30.464 357.939 83.507 16.998 9.677 25.344 24.32 25.344 44.646 0 26.266-20.685 46.848-47.104 46.848z"></path> </symbol> <symbol id="icon-instagram" viewBox="0 0 1024 1024"> <title>instagram</title> <path class="path1" d="M870.4 51.2h-716.8c-56.32 0-102.4 46.080-102.4 102.4v716.8c0 56.371 46.080 102.4 102.4 102.4h716.8c56.32 0 102.4-46.029 102.4-102.4v-716.8c0-56.32-46.080-102.4-102.4-102.4zM511.181 794.778c156.621 0 283.546-127.027 283.546-283.597 0-17.306-2.202-33.997-5.274-50.381h80.947v369.459c0 19.558-15.872 35.328-35.482 35.328h-645.837c-19.61 0-35.482-15.77-35.482-35.328v-369.459h79.309c-3.123 16.384-5.325 33.075-5.325 50.381 0 156.621 127.027 283.597 283.597 283.597zM333.978 511.181c0-97.894 79.36-177.203 177.254-177.203 97.843 0 177.254 79.309 177.254 177.203s-79.411 177.254-177.254 177.254c-97.946 0-177.254-79.36-177.254-177.254zM834.918 307.2h-82.688c-19.558 0-35.43-15.974-35.43-35.43v-82.79c0-19.558 15.872-35.379 35.379-35.379h82.688c19.661 0 35.533 15.821 35.533 35.379v82.739c0 19.507-15.872 35.482-35.482 35.482z"></path> </symbol> <symbol id="icon-linkedin" viewBox="0 0 1024 1024"> <title>linkedin</title> <path class="path1" d="M256 153.6c0 54.374-36.352 101.171-102.451 101.171-62.208 0-102.349-44.134-102.349-98.509 0-55.808 38.912-105.062 102.4-105.062s101.171 46.592 102.4 102.4zM51.2 972.8v-665.6h204.8v665.6h-204.8z"></path> <path class="path2" d="M358.4 534.733c0-79.104-2.611-145.203-5.222-202.291h184.013l9.114 88.218h3.891c25.907-41.523 89.395-102.4 195.686-102.4 129.638 0 226.918 86.784 226.918 273.51v381.030h-204.8v-351.283c0-81.613-31.078-143.872-102.4-143.872-54.374 0-81.613 44.032-95.898 80.333-5.222 13.005-6.502 31.13-6.502 49.306v365.517h-204.8v-438.067z"></path> </symbol> </defs> </svg> <!-- Google Analytics Tracking code --> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-8443903-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>
